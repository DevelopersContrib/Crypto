
<!DOCTYPE html>
<html>
<head>
  <title>Accounts</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="http://momentjs.com/downloads/moment.min.js"></script>  
  <style>
table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 100%;
}

td, th {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
}

tr:nth-child(even) {
    background-color: #dddddd;
}
</style>
</head>
<body class="container">
<h2>Token Sale: {tokensale}</h2>
<span>Funding Goal: </span><span id="fundinggoal"></span><br>
<span>Amount Raised: </span><span id="amountraised"></span><br>
<span>Deadline: </span><span id="deadline"></span> <span id="remaining"></span><br>
<h2>Accounts</h2><span id="loading">Loading...</span>
<table id="table">
<tbody>
<tr>
<td>#</td>
<td>address</td>
<td>Token</td>
<td>Eth</td>
</tr>
</tbody>
</table>

<script type="text/javascript">
var url = window.location.origin;
$(document).ready(function() {
	$.get(url+'/getBalances?address={address}&param={param}',function(data){
		var ar = jQuery.parseJSON(data).accounts;
		var theTable = "";
		for(var j=0;j<ar.length;j++){
			theTable += '<tr>';
			for(var k=0;k<ar[j].length;k++){             
				theTable += '<td>'+ar[j][k]+'</td>';
			}
			theTable += '</tr>';
		}
		$("#table").append(theTable);
		$('#loading').remove();
	});
	
	$.get(url+'/getAmountRaised?address={tokensale}',function(data){
		var data = jQuery.parseJSON(data);
		$('#amountraised').html(data.result+' Eth');
	});
	
	$.get(url+'/getDeadline?address={tokensale}',function(data){
		var data = jQuery.parseJSON(data);
		$('#deadline').html(data.result);
		
		var then = new Date();
		then.setDate(22);
		then.setHours(data.hours);
		then.setMinutes(data.minutes);
		then.setSeconds(data.seconds);
		
		var now = new Date();

		var ms = moment(then,"DD/MM/YYYY HH:mm:ss").diff(moment(now,"DD/MM/YYYY HH:mm:ss"));
		var d = moment.duration(ms);

		//$('#remaining').html(d.days()+':'+d.hours()+':'+d.minutes()+':'+d.seconds());
	});
	
	$.get(url+'/getFundingGoal?address={tokensale}',function(data){
		var data = jQuery.parseJSON(data);
		$('#fundinggoal').html(data.result+' Eth');
	});
});
</script>
</body>
	
</html>